CKEDITOR.dialog.add("mswordDialog",function(e){var b,f=new Array();var a,c,d;return{title:"MS Word",minWidth:600,minHeight:350,contents:[{id:"tab-basic",label:"Basic Settings",elements:[{type:"html",html:'<div contenteditable="true" id="ckgedit_mswin" style="width:600px; height:350px; overflow:auto;"> </div>',minWidth:350,minHeight:350,label:e.lang.geshi.code},{type:"hbox",children:[]}]}],onShow:function(){var h=this;geshi_dialog=h;selection=e.getSelection();var i=e.getSelectedHtml(true);if(i){var g=document.getElementById("ckgedit_mswin");g.innerHTML=i}},onOk:function(){var h=document.getElementById("ckgedit_mswin");var g=h.innerHTML;var i=new RegExp("<xml>([^]*)</xml>","gm");g=g.replace(i,function(j,k){return""});var i=new RegExp("<style>([^]*)</style>","gm");g=g.replace(i,function(j,k){return""});g=g.replace(/&lt/gm,"<");g=g.replace(/&gt/mg,">");g=g.replace(/<table\s+class=.*?>/mg,"<table>");g=g.replace(/<table.*?>/mg,"<table>");g=g.replace(/<tr.*?>/mg,"<tr>");g=g.replace(/<td.*?>/mg,"<td>");g=g.replace(/style="[^>]+"/gm,"");g=g.replace(/<h(\d).*?><span.*?>/gm,"<h$1>");g=g.replace(/(<span\s*>)+/gm,"");g=g.replace(/(<\/span>)+/gm,"");g=g.replace(/<tbody>([^]+)<\/tbody>/,function(j){j=j.replace(/<\/p>/mg,"");return j.replace(/<p.*?>/mg,"")});e.insertHtml(g)}}});